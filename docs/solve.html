<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resolver Ejercicio - Data Engineering Hub</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/solve.css">
</head>
<body class="solve-page">
    <header class="solve-header">
        <div class="container">
            <div class="header-top">
                <button onclick="goBack()" class="back-button">← Volver</button>
                <h1 id="exercise-title">Cargando ejercicio...</h1>
            </div>
            <div class="exercise-info">
                <span id="exercise-category" class="exercise-category"></span>
                <span id="exercise-difficulty" class="difficulty-badge"></span>
                <span class="timer-display">
                    ⏱️ <span id="timer">00:00</span> / <span id="time-limit">00:00</span>
                </span>
            </div>
        </div>
    </header>

    <main class="solve-container">
        <div class="left-panel">
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="switchLeftTab('problem')" data-tab="problem">
                    <span class="tab-icon">📋</span>
                    <span class="tab-label">Problema</span>
                </button>
                <button class="tab-btn" onclick="switchLeftTab('knowledge')" data-tab="knowledge" id="knowledge-tab-btn" style="display: none;">
                    <span class="tab-icon">📚</span>
                    <span class="tab-label">Teoría</span>
                </button>
                <button class="tab-btn" onclick="switchLeftTab('examples')" data-tab="examples" id="examples-tab-btn" style="display: none;">
                    <span class="tab-icon">📝</span>
                    <span class="tab-label">Ejemplos</span>
                </button>
                <button class="tab-btn" onclick="switchLeftTab('hints')" data-tab="hints">
                    <span class="tab-icon">💡</span>
                    <span class="tab-label">Pistas</span>
                    <span class="hints-badge" id="hints-badge">3</span>
                </button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content-container">
                <!-- Problem Tab -->
                <div class="tab-content active" id="tab-problem">
                    <div class="content-header">
                        <h2>📋 Descripción del Problema</h2>
                    </div>
                    <div id="problem-description" class="content-text">
                        Cargando...
                    </div>

                    <div class="content-header">
                        <h2>📖 Instrucciones</h2>
                    </div>
                    <div id="problem-instructions" class="content-text instructions-list">
                        Cargando...
                    </div>

                    <div class="dataset-card">
                        <div class="dataset-card-header">
                            <span class="dataset-icon">📊</span>
                            <span class="dataset-title">Dataset: <strong id="dataset-name">dataset.csv</strong></span>
                        </div>
                        <button onclick="viewDataset()" class="btn-dataset">
                            <span>👁️</span> Ver Datos Completos
                        </button>
                    </div>

                    <div class="test-cases-compact">
                        <h3>✓ Casos de Prueba</h3>
                        <div id="test-cases-list">
                            <!-- Test cases will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Knowledge Tab -->
                <div class="tab-content" id="tab-knowledge" style="display: none;">
                    <div class="content-header">
                        <h2>📚 Conocimiento Teórico</h2>
                        <p class="content-subtitle">Conceptos necesarios para resolver este ejercicio</p>
                    </div>
                    <div id="knowledge-content" class="knowledge-cards">
                        <!-- Knowledge will be loaded here -->
                    </div>
                </div>

                <!-- Examples Tab -->
                <div class="tab-content" id="tab-examples" style="display: none;">
                    <div class="content-header">
                        <h2>📝 Ejemplos de Input/Output</h2>
                        <p class="content-subtitle">Observa cómo debería funcionar tu solución</p>
                    </div>
                    <div id="examples-content" class="examples-cards">
                        <!-- Examples will be loaded here -->
                    </div>
                </div>

                <!-- Hints Tab -->
                <div class="tab-content" id="tab-hints" style="display: none;">
                    <div class="content-header">
                        <h2>💡 Pistas Progresivas</h2>
                        <p class="content-subtitle">Úsalas con sabiduría - de más general a más específica</p>
                    </div>
                    <div class="hints-info">
                        <div class="hints-counter">
                            <span class="hints-available" id="hints-remaining-display">3</span>
                            <span class="hints-label">pistas disponibles</span>
                        </div>
                    </div>
                    <div id="hints-content" class="hints-list">
                        <!-- Hints will be loaded here -->
                        <div class="hints-empty">
                            <p>Click el botón para revelar la primera pista</p>
                        </div>
                    </div>
                    <button onclick="revealNextHint()" class="btn-reveal-hint" id="reveal-hint-btn">
                        🔓 Revelar Siguiente Pista
                    </button>
                </div>
            </div>
        </div>

        <div class="right-panel">
            <div class="editor-section">
                <div class="editor-header">
                    <h2>Editor de Código</h2>
                    <div class="editor-controls">
                        <button id="reset-code" class="btn-secondary" onclick="resetCode()">
                            🔄 Reset
                        </button>
                        <button id="run-code" class="btn-primary" onclick="runCode()">
                            ▶️ Ejecutar
                        </button>
                    </div>
                </div>
                <div id="code-editor" class="code-editor-container"></div>
            </div>

            <div class="output-section">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('output')">Salida</button>
                    <button class="tab" onclick="switchTab('console')">Consola</button>
                    <button class="tab" onclick="switchTab('results')">Resultados</button>
                </div>
                <div id="output-content" class="output-content">
                    <div class="placeholder">
                        Ejecuta tu código para ver los resultados aquí
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Modal -->
    <div id="loading-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="loader"></div>
            <p>Ejecutando código...</p>
        </div>
    </div>

    <!-- Results Modal -->
    <div id="results-modal" class="modal" style="display: none;">
        <div class="modal-content results-modal">
            <h2 id="results-title">Resultados</h2>
            <div id="results-content"></div>
            <div class="modal-actions">
                <button onclick="closeResultsModal()" class="btn-primary">Cerrar</button>
                <button onclick="goBack()" class="btn-secondary">Volver al Inicio</button>
            </div>
        </div>
    </div>

    <!-- Hint Modal -->
    <div id="hint-modal" class="modal" style="display: none;">
        <div class="modal-content hint-modal">
            <div class="modal-header">
                <h2>💡 Pista <span id="current-hint-number"></span></h2>
                <button onclick="closeHintModal()" class="close-btn">✕</button>
            </div>
            <div id="hint-content" class="hint-content">
                <!-- Hint will be loaded here -->
            </div>
            <div class="modal-actions">
                <button onclick="closeHintModal()" class="btn-primary">Entendido</button>
                <button onclick="showHint()" class="btn-secondary" id="next-hint-btn">
                    Siguiente Pista (<span id="hints-remaining-modal">2</span>)
                </button>
            </div>
        </div>
    </div>

    <!-- Dataset Modal -->
    <div id="dataset-modal" class="modal" style="display: none;">
        <div class="modal-content dataset-modal">
            <div class="modal-header">
                <h2>📊 Dataset: <span id="dataset-modal-name"></span></h2>
                <button onclick="closeDatasetModal()" class="close-btn">✕</button>
            </div>
            <div class="dataset-info-text">
                <p><strong>Filas:</strong> <span id="dataset-rows">0</span> | <strong>Columnas:</strong> <span id="dataset-cols">0</span></p>
            </div>
            <div id="dataset-content" class="dataset-content">
                <!-- Dataset table will be loaded here -->
            </div>
            <div class="modal-actions">
                <button onclick="closeDatasetModal()" class="btn-primary">Cerrar</button>
                <button onclick="downloadDataset()" class="btn-secondary">⬇️ Descargar CSV</button>
            </div>
        </div>
    </div>

    <!-- Monaco Editor -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    <script src="js/solve.js"></script>
</body>
</html>
